[2021-10-12 13:35:24,589] {taskinstance.py:897} INFO - Dependencies not met for <TaskInstance: estate_pipeline.data_reader 2021-10-07T00:00:00+00:00 [up_for_retry]>, dependency 'Not In Retry Period' FAILED: Task is not ready for retry yet but will be retried automatically. Current date is 2021-10-12T05:35:24.589139+00:00 and task will be retried at 2021-10-12T05:38:11.663011+00:00.
[2021-10-12 13:35:24,592] {local_task_job.py:96} INFO - Task is not able to be run
[2021-10-12 13:40:43,658] {taskinstance.py:903} INFO - Dependencies all met for <TaskInstance: estate_pipeline.data_reader 2021-10-07T00:00:00+00:00 [queued]>
[2021-10-12 13:40:43,666] {taskinstance.py:903} INFO - Dependencies all met for <TaskInstance: estate_pipeline.data_reader 2021-10-07T00:00:00+00:00 [queued]>
[2021-10-12 13:40:43,666] {taskinstance.py:1095} INFO - 
--------------------------------------------------------------------------------
[2021-10-12 13:40:43,666] {taskinstance.py:1096} INFO - Starting attempt 2 of 3
[2021-10-12 13:40:43,666] {taskinstance.py:1097} INFO - 
--------------------------------------------------------------------------------
[2021-10-12 13:40:43,673] {taskinstance.py:1115} INFO - Executing <Task(PythonOperator): data_reader> on 2021-10-07T00:00:00+00:00
[2021-10-12 13:40:43,676] {standard_task_runner.py:52} INFO - Started process 19566 to run task
[2021-10-12 13:40:43,681] {standard_task_runner.py:76} INFO - Running: ['airflow', 'tasks', 'run', 'estate_pipeline', 'data_reader', '2021-10-07T00:00:00+00:00', '--job-id', '9', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/main_dag.py', '--cfg-path', '/tmp/tmpdpshaugs', '--error-file', '/tmp/tmp5t5ryi0v']
[2021-10-12 13:40:43,685] {standard_task_runner.py:77} INFO - Job 9: Subtask data_reader
[2021-10-12 13:40:43,733] {logging_mixin.py:109} INFO - Running <TaskInstance: estate_pipeline.data_reader 2021-10-07T00:00:00+00:00 [running]> on host ubuntu
[2021-10-12 13:40:43,759] {taskinstance.py:1254} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=swchen1282@gmail.com
AIRFLOW_CTX_DAG_OWNER=swc
AIRFLOW_CTX_DAG_ID=estate_pipeline
AIRFLOW_CTX_TASK_ID=data_reader
AIRFLOW_CTX_EXECUTION_DATE=2021-10-07T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-10-07T00:00:00+00:00
[2021-10-12 13:40:43,760] {logging_mixin.py:109} INFO - absolute_path=/home/dev/cbkpi/app/airflow_root/dags
[2021-10-12 13:40:43,760] {logging_mixin.py:109} INFO - data_source_path=/home/dev/cbkpi/app
[2021-10-12 13:40:43,761] {logging_mixin.py:109} INFO - ['107S4.zip', '108S2.zip', '108S3.zip', '107S1', '107S1.zip', '109S1', '106S1', '108S4.zip', '108S4', '107S2', '107S2.zip', '106S2.zip', '108S3', '109S2', '109S4.zip', '106S2', '107S4', '106S3', '108S1', '109S2.zip', '106S3.zip', '106S4.zip', '109S3', '109S4', '109S1.zip', '106S4', '107S3', '108S1.zip', '106S1.zip', '107S3.zip', '108S2', '109S3.zip']
[2021-10-12 13:40:43,761] {logging_mixin.py:109} INFO - current path is: /home/dev/cbkpi/app/data_source; start data processing
[2021-10-12 13:40:43,764] {logging_mixin.py:109} INFO - 107S4.zip is a zip file, skip
[2021-10-12 13:40:43,764] {logging_mixin.py:109} INFO - 108S2.zip is a zip file, skip
[2021-10-12 13:40:43,764] {logging_mixin.py:109} INFO - 108S3.zip is a zip file, skip
[2021-10-12 13:40:43,798] {logging_mixin.py:109} INFO - import 107_1_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:43,963] {logging_mixin.py:109} INFO - import 107_1_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:43,987] {logging_mixin.py:109} INFO - import 107_1_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:44,075] {logging_mixin.py:109} INFO - import 107_1_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,145] {logging_mixin.py:109} INFO - import 107_1_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,145] {logging_mixin.py:109} INFO - 107S1.zip is a zip file, skip
[2021-10-12 13:40:44,180] {logging_mixin.py:109} INFO - import 109_1_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:44,318] {logging_mixin.py:109} INFO - import 109_1_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,344] {logging_mixin.py:109} INFO - import 109_1_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:44,438] {logging_mixin.py:109} INFO - import 109_1_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,521] {logging_mixin.py:109} INFO - import 109_1_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,566] {logging_mixin.py:109} INFO - import 106_1_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:44,686] {logging_mixin.py:109} INFO - import 106_1_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,738] {logging_mixin.py:109} INFO - import 106_1_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:44,830] {logging_mixin.py:109} INFO - import 106_1_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,911] {logging_mixin.py:109} INFO - import 106_1_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:44,912] {logging_mixin.py:109} INFO - 108S4.zip is a zip file, skip
[2021-10-12 13:40:44,980] {logging_mixin.py:109} INFO - import 108_4_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:45,135] {logging_mixin.py:109} INFO - import 108_4_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:45,213] {logging_mixin.py:109} INFO - import 108_4_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:45,334] {logging_mixin.py:109} INFO - import 108_4_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:45,462] {logging_mixin.py:109} INFO - import 108_4_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:45,550] {logging_mixin.py:109} INFO - import 107_2_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:45,690] {logging_mixin.py:109} INFO - import 107_2_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:45,786] {logging_mixin.py:109} INFO - import 107_2_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:45,900] {logging_mixin.py:109} INFO - import 107_2_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:46,070] {logging_mixin.py:109} INFO - import 107_2_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:46,070] {logging_mixin.py:109} INFO - 107S2.zip is a zip file, skip
[2021-10-12 13:40:46,070] {logging_mixin.py:109} INFO - 106S2.zip is a zip file, skip
[2021-10-12 13:40:46,257] {logging_mixin.py:109} INFO - import 108_3_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:46,475] {logging_mixin.py:109} INFO - import 108_3_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:46,623] {logging_mixin.py:109} INFO - import 108_3_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:46,809] {logging_mixin.py:109} INFO - import 108_3_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:47,083] {logging_mixin.py:109} INFO - import 108_3_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:47,298] {logging_mixin.py:109} INFO - import 109_2_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:47,542] {logging_mixin.py:109} INFO - import 109_2_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:47,741] {logging_mixin.py:109} INFO - import 109_2_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:47,994] {logging_mixin.py:109} INFO - import 109_2_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:48,353] {logging_mixin.py:109} INFO - import 109_2_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:48,353] {logging_mixin.py:109} INFO - 109S4.zip is a zip file, skip
[2021-10-12 13:40:48,724] {logging_mixin.py:109} INFO - import 106_2_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:49,036] {logging_mixin.py:109} INFO - import 106_2_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:49,325] {logging_mixin.py:109} INFO - import 106_2_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:49,684] {logging_mixin.py:109} INFO - import 106_2_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:50,001] {logging_mixin.py:109} INFO - import 107_4_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:50,364] {logging_mixin.py:109} INFO - import 107_4_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:50,723] {logging_mixin.py:109} INFO - import 107_4_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:51,003] {logging_mixin.py:109} INFO - import 107_4_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:51,436] {logging_mixin.py:109} INFO - import 107_4_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:51,810] {logging_mixin.py:109} INFO - import 106_3_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:52,168] {logging_mixin.py:109} INFO - import 106_3_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:52,596] {logging_mixin.py:109} INFO - import 106_3_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:52,896] {logging_mixin.py:109} INFO - import 106_3_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:53,390] {logging_mixin.py:109} INFO - import 106_3_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:53,962] {logging_mixin.py:109} INFO - import 108_1_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:54,588] {logging_mixin.py:109} INFO - import 108_1_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:55,130] {logging_mixin.py:109} INFO - import 108_1_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:55,475] {logging_mixin.py:109} INFO - import 108_1_E_A data into pd.DataFrame successfully
[2021-10-12 13:40:56,008] {logging_mixin.py:109} INFO - import 108_1_A_A data into pd.DataFrame successfully
[2021-10-12 13:40:56,008] {logging_mixin.py:109} INFO - 109S2.zip is a zip file, skip
[2021-10-12 13:40:56,008] {logging_mixin.py:109} INFO - 106S3.zip is a zip file, skip
[2021-10-12 13:40:56,008] {logging_mixin.py:109} INFO - 106S4.zip is a zip file, skip
[2021-10-12 13:40:56,500] {logging_mixin.py:109} INFO - import 109_3_B_B data into pd.DataFrame successfully
[2021-10-12 13:40:56,678] {logging_mixin.py:109} WARNING - /home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/taskinstance.py:1313 DtypeWarning: Columns (3,7,14,15,16,17,18,21,22,24,25) have mixed types.Specify dtype option on import or set low_memory=False.
[2021-10-12 13:40:57,015] {logging_mixin.py:109} INFO - import 109_3_F_A data into pd.DataFrame successfully
[2021-10-12 13:40:58,137] {logging_mixin.py:109} INFO - import 109_3_H_B data into pd.DataFrame successfully
[2021-10-12 13:40:59,406] {logging_mixin.py:109} INFO - import 109_3_E_A data into pd.DataFrame successfully
[2021-10-12 13:41:01,228] {logging_mixin.py:109} INFO - import 109_3_A_A data into pd.DataFrame successfully
[2021-10-12 13:41:02,496] {logging_mixin.py:109} INFO - import 109_4_B_B data into pd.DataFrame successfully
[2021-10-12 13:41:03,600] {logging_mixin.py:109} INFO - import 109_4_F_A data into pd.DataFrame successfully
[2021-10-12 13:41:04,751] {logging_mixin.py:109} INFO - import 109_4_H_B data into pd.DataFrame successfully
[2021-10-12 13:41:05,889] {logging_mixin.py:109} INFO - import 109_4_E_A data into pd.DataFrame successfully
[2021-10-12 13:41:07,102] {logging_mixin.py:109} INFO - import 109_4_A_A data into pd.DataFrame successfully
[2021-10-12 13:41:07,102] {logging_mixin.py:109} INFO - 109S1.zip is a zip file, skip
[2021-10-12 13:41:08,656] {logging_mixin.py:109} INFO - import 106_4_B_B data into pd.DataFrame successfully
[2021-10-12 13:41:10,223] {logging_mixin.py:109} INFO - import 106_4_F_A data into pd.DataFrame successfully
[2021-10-12 13:41:11,788] {logging_mixin.py:109} INFO - import 106_4_H_B data into pd.DataFrame successfully
[2021-10-12 13:41:13,246] {logging_mixin.py:109} INFO - import 106_4_E_A data into pd.DataFrame successfully
[2021-10-12 13:41:14,954] {logging_mixin.py:109} INFO - import 106_4_A_A data into pd.DataFrame successfully
[2021-10-12 13:41:16,377] {logging_mixin.py:109} INFO - import 107_3_B_B data into pd.DataFrame successfully
[2021-10-12 13:41:18,615] {logging_mixin.py:109} INFO - import 107_3_F_A data into pd.DataFrame successfully
[2021-10-12 13:41:20,904] {logging_mixin.py:109} INFO - import 107_3_H_B data into pd.DataFrame successfully
[2021-10-12 13:41:23,049] {logging_mixin.py:109} INFO - import 107_3_E_A data into pd.DataFrame successfully
[2021-10-12 13:41:25,322] {logging_mixin.py:109} INFO - import 107_3_A_A data into pd.DataFrame successfully
[2021-10-12 13:41:25,322] {logging_mixin.py:109} INFO - 108S1.zip is a zip file, skip
[2021-10-12 13:41:25,323] {logging_mixin.py:109} INFO - 106S1.zip is a zip file, skip
[2021-10-12 13:41:25,323] {logging_mixin.py:109} INFO - 107S3.zip is a zip file, skip
[2021-10-12 13:41:27,455] {logging_mixin.py:109} INFO - import 108_2_B_B data into pd.DataFrame successfully
[2021-10-12 13:41:29,329] {logging_mixin.py:109} INFO - import 108_2_F_A data into pd.DataFrame successfully
[2021-10-12 13:41:31,099] {logging_mixin.py:109} INFO - import 108_2_H_B data into pd.DataFrame successfully
[2021-10-12 13:41:33,540] {logging_mixin.py:109} INFO - import 108_2_E_A data into pd.DataFrame successfully
[2021-10-12 13:41:35,467] {logging_mixin.py:109} INFO - import 108_2_A_A data into pd.DataFrame successfully
[2021-10-12 13:41:35,468] {logging_mixin.py:109} INFO - 109S3.zip is a zip file, skip
[2021-10-12 13:41:35,468] {python.py:151} INFO - Done. Returned value was:      The villages and towns urban district transaction sign land sector position building sector house number plate land shifting total area square meter  ...   NaN    NaN NaN NaN
1                                      北屯區     房地(土地+建物)+車位                  臺中市北屯區陳平段1935.仁德段1038-3.仁德段1038-7                                      18.69  ...   NaN    NaN NaN NaN
2                                      北屯區     房地(土地+建物)+車位                  臺中市北屯區陳平段1935.仁德段1038-3.仁德段1038-7                                      18.69  ...   NaN    NaN NaN NaN
3                                      北屯區     房地(土地+建物)+車位                  臺中市北屯區陳平段1935.仁德段1038-3.仁德段1038-7                                      18.69  ...   NaN    NaN NaN NaN
4                                      北屯區     房地(土地+建物)+車位                  臺中市北屯區陳平段1935.仁德段1038-3.仁德段1038-7                                      20.87  ...   NaN    NaN NaN NaN
5                                      北屯區     房地(土地+建物)+車位                  臺中市北屯區陳平段1935.仁德段1038-3.仁德段1038-7                                      19.94  ...   NaN    NaN NaN NaN
...                                    ...              ...                                                ...                                        ...  ...   ...    ...  ..  ..
5591                                   文山區     房地(土地+建物)+車位                                  臺北市文山區汀州路四段273號九樓                                       35.8  ...  0.00  11.11 NaN NaN
5592                                   文山區        房地(土地+建物)                                 臺北市文山區辛亥路七段２０巷１弄２號                                      24.61  ...  0.27   0.00 NaN NaN
5593                                   文山區     房地(土地+建物)+車位                                臺北市文山區忠順街一段４８巷５弄１０號                                      54.64  ...  0.00  15.19 NaN NaN
5594                                   中正區     房地(土地+建物)+車位                                   臺北市中正區?m門街７７號１２樓                                      12.52  ...  0.86   8.31 NaN NaN
5595                                   中正區        房地(土地+建物)                                 臺北市中正區?m門街７７號１２樓之１                                      10.25  ...  1.38   3.55 NaN NaN

[489244 rows x 264 columns]
[2021-10-12 13:41:36,629] {xcom.py:229} ERROR - Could not serialize the XCom value into JSON. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your airflow config.
[2021-10-12 13:41:36,629] {taskinstance.py:1463} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1165, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1283, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1316, in _execute_task
    self.xcom_push(key=XCOM_RETURN_KEY, value=result)
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1905, in xcom_push
    session=session,
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/utils/session.py", line 67, in wrapper
    return func(*args, **kwargs)
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/xcom.py", line 79, in set
    value = XCom.serialize_value(value)
  File "/home/dev/cbkpi/venv/lib/python3.6/site-packages/airflow/models/xcom.py", line 226, in serialize_value
    return json.dumps(value).encode('UTF-8')
  File "/usr/lib/python3.6/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/lib/python3.6/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.6/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/lib/python3.6/json/encoder.py", line 180, in default
    o.__class__.__name__)
TypeError: Object of type 'DataFrame' is not JSON serializable
[2021-10-12 13:41:36,636] {taskinstance.py:1513} INFO - Marking task as UP_FOR_RETRY. dag_id=estate_pipeline, task_id=data_reader, execution_date=20211007T000000, start_date=20211012T054043, end_date=20211012T054136
[2021-10-12 13:41:36,681] {local_task_job.py:151} INFO - Task exited with return code 1
[2021-10-12 13:41:36,692] {local_task_job.py:261} INFO - 0 downstream tasks scheduled from follow-on schedule check
